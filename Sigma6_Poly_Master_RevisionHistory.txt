
                 'Sigma-6 Poly Master Controller' (SAMD21 MCU)

                         Firmware Revision History

================================================================================

v0.5  25-08-2025  (WIP)
```````````````````````
Migrated code from ItsyBitsy M0 Synth.  Removed unwanted functionality.

Adapted OLED display code to suit SSD1309 controller.

Adapted EEPROM driver code to suit 24LC64 (8k x 8).

Changed ADC input for Data Entry Pot: Use pin A11. (A12/AREF N/A in library.)


v0.75  02-09-2025
`````````````````
Removed 'Voice Params' UI screen.  Added #define to set NUMBER_OF_VOICES.

The number of Presets supported by the Master Controller is determined by the
number of Preset names (strings) defined in the array *PresetName[], located
in source file "poly_synth_panel.ino".

Hence, if the number of Presets implemented in the voice modules is extended,
then the names of the additional Presets should be added to the array.
Otherwise, the additional Presets in the voice module will be inaccessible.

Added "Display Brightness" UI screen to set OLED contrast (brightness).


v0.80  18-09-2025 *
`````````````````
Added complete Preset/Patch table... copied from Poly-voice firmware.

The number of Presets supported by the Master Controller is determined by the
number of Presets defined in the array PresetPatch[] in flash memory.

Added User Presets (8) saved in EEPROM via 'SET_USER_PRESET' screen.
When Affirmed, active patch is saved as the currently selected Favorite.
A User Preset is recalled by pressing one of the Favorite Preset buttons.

Default Favorites are Voice Presets 1..8 (loaded from PresetPatch[] table).

Added Command-Line User Interface (CLI) on USB-serial port.

Commands implemented in this FW version:
````````````````````````````````````````
'patch' - prints the active patch param values in C source code format;
'save'  - saves the active patch as a 'User Preset' in a Favorite (1..8),
            and (optionally) assigns a name to the saved Preset;
'help'  - prints a command usage summary.

* NB: "Factory reset" will occur with this firmware version...
  EEPROM data defaulted - Config param's and Fav. Presets.


v0.85  19-09-2025 *
`````````````````
Fixed major defect:  v0.80 omitted function RecallUserPreset() which sends
(potentially) modified patch parameters to the voice modules when a Favorite
Preset is selected.

When a User Preset (Favorite) is recalled, the master must send to the voices
(via MIDI) any patch parameters which have been modified to create the User 
Preset. In fact, the master sends all patch param's which can be modified via
the UI (control panel), regardless of which param's differ from the Factory 
Preset (base) values. 

Added icon on HOME screen to indicate 'Patch Modified'.


v0.86  21-09-2025
`````````````````
Fixed bug: 'Last selected Preset' was corrupted by recall of a Favorite.


v0.87  27-09-2025
`````````````````
Fixed bug: The SETUP menu item 'VOICE TUNING' was bypassed accidentally.


v0.88  04-10-2025
`````````````````
Fixed bug:  
  Reverb Mix (config param) was not transmitted to voice modules at start-up.

Modified start-up function to amend voice modules initialization:
  . Reverb Mix param is recalled from EEPROM and transmitted to voice modules;
  . If pitch bend is enabled, vibrato is disabled, and vice-versa.

Modified UI screen function for Pitch Bend setup:
  . If pitch bend is enabled, vibrato is disabled, and vice-versa.

Modified UI screen functions for LFO Freq and LFO Depth setting:
  . If Data Entry pot moved, new setting is sent to voice modules immediately
    and the active patch param is updated.
  . Removed 'Affirm' button function (redundant). Replaced with 'Done'.


v0.90  19-10-2025 *
`````````````````
> Added support for LED indicators on Favorite button/switches.

> Added support for Osc Mix slider pots and add OSC MIXER LEVELS screen.

> Added 'heartbeat' indicator = MCU on-board 'TX' LED (blue).

* NB: "Factory reset" will occur with this firmware version...
  EEPROM data defaulted - Config param's and Fav. Presets.
  Voice 'Fine Tuning' parameters will need to be restored manually.


v0.91  23-10-2025  (not released)
``````````````````
Fixed bug in SPI usage:  LED register requires clock mode 3.


v0.95  17-11-2025  (sent to JPM for testing)
``````````````````
Fixed bug:  Voice module initialization - Did not allow enough time after 
power-on/reset to begin sending param's.  Voice module initialization now
occurs after the Start-up screen wait time has elapsed (5 sec).

Added "N-key rollover" to Note-On algorithm:  
If a Note-On message is received while all voice channels are busy, the oldest
note will be terminated and the new note will be initiated after a 5ms delay.

Added LFO control pots: LFO Freq, LFO Depth... real-time control.

Improved response time and noise immunity of sliders & LFO control pots...
  . Reduced pot service interval to 1ms;  read 1 pot per call for 9ms cycle.
  . Applied IIR filter with K = 1/2 for settling time = 9ms x 5 = 45ms (approx).


v0.97  19-11-2025
`````````````````
Cosmetic improvements to 'Osc Mixer levels' screen. (Whole dotted lines.)

Control pots 'LFO Freq' and 'LFO Depth' do not affect active Patch param's.
Use 'Data Entry Pot' to adjust LFO _Patch_ param's, to make persistent.

Added 'Master Tune' UI function & MIDI support for Master Tune param.


v1.00  22-11-2025  [released to GitHub]
```````````````````````````````````````
If LFO Depth is adjusted using LFO Depth pot, maximum value is 100 cents;
otherwise, max. is 200 cents.

Fix a bug in 'Master Tune' UI screen: The word "cents" was partly erased.



--------------------------------------------------------------------------------

To Do:  
```````
> Add 32 more presets to provide a methodical selection of various patch 
  parameters not adjustable from the Master controller; i.e:
  Osc. freq mult. (x6), Osc. modulation source (x6), Osc. Detune (x6).
  Other preset param's set to "typical" values, but these are adjustable
  anyway via the Master front-panel user-interface or by MIDI CC messages.

> Add PATCH screens to adjust Contour Env (Slope & Ramp time), Transient Env
  (Decay time and Sustain level) and LFO AM Depth parameters.

> Add LFO synchronization option -- keep all voices LFOs in phase.

> Add HOLD (sustain) function... control by ext. switch/pedal or MIDI msg.

  When HOLD is activated, all voices ENV Sustain level is set to 70% (TBD) 
  and Release time is set to 2000ms (TBD). When HOLD is de-activated, 
  all voices ENV Sustain and Release param's are restored to Preset levels.
  Voice ENV param changes are temporary only... the master Patch param's
  are not changed by the Hold/Sustain function.

> Add "multi-timbral" option -- for use with DAW/sequencer, as follows:

  Provide extra SETUP screen "VOICE CONFIG." to set number of Poly voices.
  Voice modules with MIDI channel set below or equal to this number will be 
  handled as members of a polyphonic group.  Voice modules with higher MIDI 
  channel will be handled as independent monophonic voices, each of which can
  be configured with a different sound preset (via MIDI Program Change).

  MIDI voice messages addressed to the MIDI "basic" channel (Master) will be 
  processed in polyphonic mode. Otherwise, MIDI messages will be passed through
  to monophonic voices with MIDI channel corresponding to the message address.


________________________________________________________________________________

Sigma6_Poly_Master_RevisionHistory.txt                           www.mjbauer.biz  
